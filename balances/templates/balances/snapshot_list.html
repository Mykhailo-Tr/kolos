{% extends "base.html" %}
{% load humanize %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/journal.css' %}">

<div class="journal-container">
  <div class="page-header">
    <h1 class="page-title">üìä {{ model_name }}</h1>
    <div style="display: flex; gap: 0.75rem;">
      <a href="{% url 'balance_list' %}" class="btn-add" style="background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);">
        <span>‚Ü©Ô∏è</span>
        <span>–î–æ –∑–∞–ª–∏—à–∫—ñ–≤</span>
      </a>
      <button type="button" class="btn-add" data-bs-toggle="modal" data-bs-target="#createSnapshotModal">
        <span>üíæ</span>
        <span>–°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–ª—ñ–ø–æ–∫</span>
      </button>
    </div>
  </div>

  {% if snapshots %}
    <div class="table-wrapper">
      <table class="journal-table">
        <thead>
          <tr>
            <th>#</th>
            <th>–î–∞—Ç–∞ —ñ —á–∞—Å</th>
            <th>–û–ø–∏—Å</th>
            <th>–°—Ç–≤–æ—Ä–µ–Ω–æ</th>
            <th>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Å—ñ–≤</th>
            <th>–ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å (—Ç)</th>
            <th>–î—ñ—ó</th>
          </tr>
        </thead>
        <tbody>
          {% for snapshot in snapshots %}
          <tr>
            <td class="text-center">{{ forloop.counter }}</td>
            <td>{{ snapshot.snapshot_date|date:"d.m.Y H:i" }}</td>
            <td>{{ snapshot.description|default:"‚Äî" }}</td>
            <td>{{ snapshot.created_by }}</td>
            <td class="text-center">{{ snapshot.total_records }}</td>
            <td class="text-end">
              <span class="quantity-value">{{ snapshot.total_quantity|floatformat:3 }}</span>
            </td>
            <td>
              <div class="actions-cell">
                <a href="{% url 'balance_snapshot_detail' snapshot.pk %}" class="btn-action" style="background: #3b82f6; color: white;" title="–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏">üëÅÔ∏è</a>
                <a href="{% url 'balance_snapshot_update' snapshot.pk %}" class="btn-action" style="background: #10b981; color: white;" title="–†–µ–¥–∞–≥—É–≤–∞—Ç–∏">‚úèÔ∏è</a>
                <a href="{% url 'balance_snapshot_delete' snapshot.pk %}" class="btn-action btn-delete" title="–í–∏–¥–∞–ª–∏—Ç–∏">üóëÔ∏è</a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- –ü–∞–≥—ñ–Ω–∞—Ü—ñ—è -->
    {% if is_paginated %}
    <nav aria-label="–ù–∞–≤—ñ–≥–∞—Ü—ñ—è –ø–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∞—Ö" class="mt-4">
      <ul class="pagination justify-content-center">
        {% if page_obj.has_previous %}
          <li class="page-item">
            <a class="page-link" href="?page=1">–ü–µ—Ä—à–∞</a>
          </li>
          <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.previous_page_number }}">–ü–æ–ø–µ—Ä–µ–¥–Ω—è</a>
          </li>
        {% endif %}

        <li class="page-item active">
          <span class="page-link">–°—Ç–æ—Ä—ñ–Ω–∫–∞ {{ page_obj.number }} –∑ {{ page_obj.paginator.num_pages }}</span>
        </li>

        {% if page_obj.has_next %}
          <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.next_page_number }}">–ù–∞—Å—Ç—É–ø–Ω–∞</a>
          </li>
          <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}">–û—Å—Ç–∞–Ω–Ω—è</a>
          </li>
        {% endif %}
      </ul>
    </nav>
    {% endif %}
  {% else %}
    <div class="alert-info">
      –ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö –∑–ª—ñ–ø–∫—ñ–≤ –∑–∞–ª–∏—à–∫—ñ–≤. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É "–°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–ª—ñ–ø–æ–∫" –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Å—Ç–∞–Ω—É.
    </div>
  {% endif %}
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–ª—ñ–ø–∫—É -->
<div class="modal fade" id="createSnapshotModal" tabindex="-1" aria-labelledby="createSnapshotModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="createSnapshotModalLabel">üíæ –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–ª—ñ–ø–æ–∫ –∑–∞–ª–∏—à–∫—ñ–≤</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="–ó–∞–∫—Ä–∏—Ç–∏"></button>
      </div>
      <form method="post" action="{% url 'balance_snapshot_create' %}">
        {% csrf_token %}
        <div class="modal-body">
          <div class="mb-3">
            <label for="description" class="form-label">–û–ø–∏—Å –∑–ª—ñ–ø–∫—É (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)</label>
            <input type="text" class="form-control" id="description" name="description" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –ó–∞–ª–∏—à–∫–∏ –Ω–∞ –∫—ñ–Ω–µ—Ü—å –º—ñ—Å—è—Ü—è">
            <div class="form-text">–î–æ–¥–∞–π—Ç–µ –æ–ø–∏—Å, —â–æ–± –ª–µ–≥–∫–æ –∑–Ω–∞–π—Ç–∏ —Ü–µ–π –∑–ª—ñ–ø–æ–∫ –ø—ñ–∑–Ω—ñ—à–µ</div>
          </div>
          <div class="alert alert-info mb-0">
            <strong>‚ÑπÔ∏è –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è:</strong> –ë—É–¥–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ –ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω –≤—Å—ñ—Ö –∑–∞–ª–∏—à–∫—ñ–≤ –Ω–∞ —Å–∫–ª–∞–¥–∞—Ö.
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
          <button type="submit" class="btn btn-primary">üíæ –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–ª—ñ–ø–æ–∫</button>
        </div>
      </form>
    </div>
  </div>
</div>

{% endblock %}