{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'reports/css/pdf_dashboard.css' %}">
<link rel="stylesheet" href="{% static 'css/live_clock.css' %}">

{% endblock %}

{% block content %}
<div class="pdf-reports-container">
    <div class="reports-header">
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
            <h1 class="reports-title">
                <span>üìÑ</span>
                <span>PDF –ó–≤—ñ—Ç–∏</span>

            </h1>
            <div style="display: flex; align-items: center; gap: 15px;">
                <div id="live-clock" class="live-clock-badge"></div> 

                <a href="{% url 'reports_dashboard' %}" class="btn btn-primary">
                    <i class="fas fa-file-pdf" style="margin-right: 8px;"></i> ‚Üê –ó–≤—ñ—Ç–∏ 
                </a>
            </div>
        </div>
    </div>

    <!-- –¢–∏–ø–∏ –∑–≤—ñ—Ç—ñ–≤ -->
    <div class="section">
        <h2 class="section-title">–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –∑–≤—ñ—Ç</h2>
        
        <div class="reports-grid">
            <!-- –ó–∞–ª–∏—à–∫–∏ –∑–∞ –¥–∞—Ç—É -->
            <a href="{% url 'pdf_balance_date' %}" class="report-type-card">
                <div class="report-icon">üìä</div>
                <h3 class="report-type-title">–ó–∞–ª–∏—à–∫–∏ –∑–∞ –¥–∞—Ç—É</h3>
                <p class="report-type-desc">
                    –°—Ç–∞–Ω –∑–∞–ª–∏—à–∫—ñ–≤ –Ω–∞ —Å–∫–ª–∞–¥–∞—Ö –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É –¥–∞—Ç—É
                </p>
            </a>


            <!-- –ü—Ä–∏—Ö—ñ–¥ –∑–∞ –¥–∞—Ç—É -->
            <a href="{% url 'pdf_income_date' %}" class="report-type-card">
                <div class="report-icon">üå±</div>
                <h3 class="report-type-title">–ü—Ä–∏—Ö—ñ–¥ –∑–∞ –¥–∞—Ç—É</h3>
                <p class="report-type-desc">
                    –ù–∞–¥—Ö–æ–¥–∂–µ–Ω–Ω—è –∑–µ—Ä–Ω–∞ –∑ –ø–æ–ª—ñ–≤ –∑–∞ –¥–µ–Ω—å
                </p>
            </a>

            <!-- –ü—Ä–∏—Ö—ñ–¥ –∑–∞ –ø–µ—Ä—ñ–æ–¥ -->
            <a href="{% url 'pdf_income_period' %}" class="report-type-card">
                <div class="report-icon">üì¶</div>
                <h3 class="report-type-title">–ü—Ä–∏—Ö—ñ–¥ –∑–∞ –ø–µ—Ä—ñ–æ–¥</h3>
                <p class="report-type-desc">
                    –ó–∞–≥–∞–ª—å–Ω–µ –Ω–∞–¥—Ö–æ–¥–∂–µ–Ω–Ω—è –∑–µ—Ä–Ω–∞ –∑–∞ –ø–µ—Ä—ñ–æ–¥
                </p>
            </a>

            <!-- –í–≤–µ–∑–µ–Ω–Ω—è/–í–∏–≤–µ–∑–µ–Ω–Ω—è -->
            <a href="{% url 'pdf_shipment_summary' %}" class="report-type-card">
                <div class="report-icon">üöõ</div>
                <h3 class="report-type-title">–í–≤–µ–∑–µ–Ω–Ω—è/–í–∏–≤–µ–∑–µ–Ω–Ω—è</h3>
                <p class="report-type-desc">
                    –ó–æ–≤–Ω—ñ—à–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑–∞ –ø–µ—Ä—ñ–æ–¥
                </p>
            </a>

            <!-- –ó–∞–≥–∞–ª—å–Ω–∏–π –ø—Ä–∏—Ö—ñ–¥ –∑–∞ –ø–µ—Ä—ñ–æ–¥ -->
            <a href="{% url 'pdf_total_income_period' %}" class="report-type-card">
                <div class="report-icon">üì•</div>
                <h3 class="report-type-title">–ó–∞–≥–∞–ª—å–Ω–∏–π –ø—Ä–∏—Ö—ñ–¥ –∑–µ—Ä–Ω–∞</h3>
                <p class="report-type-desc">
                    –û–±'—î–¥–Ω–∞–Ω–∏–π –ø—Ä–∏—Ö—ñ–¥ –∑ –ø–æ–ª—ñ–≤ —Ç–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ –≤–≤–µ–∑–µ–Ω–Ω—è
                </p>
            </a>
        </div>
    </div>

    <div class="row">
        <!-- –û—Å—Ç–∞–Ω–Ω—ñ –∑–≤—ñ—Ç–∏ -->
        <div class="col-md-6">
            <div class="section">
                <h2 class="section-title">
                    <span>üìú –û—Å—Ç–∞–Ω–Ω—ñ –∑–≤—ñ—Ç–∏</span>
                    <a href="{% url 'report_execution_list' %}" class="section-link">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤—Å—ñ ‚Üí</a>
                </h2>

                {% if recent_executions %}
                    <ul class="recent-list">
                        {% for execution in recent_executions %}
                        <li class="recent-item">
                            <div>
                                <div class="recent-item-title">
                                    {% if execution.template %}
                                        {{ execution.template.name }}
                                    {% else %}
                                        {{ execution.get_report_type_display|default:execution.report_type }}
                                    {% endif %}
                                </div>
                                <div class="recent-item-meta">
                                    {{ execution.executed_at|date:"d.m.Y H:i" }} ‚Ä¢ 
                                    {{ execution.row_count }} –∑–∞–ø–∏—Å—ñ–≤
                                </div>
                            </div>
                            <div class="recent-item-actions">
                                {% if execution.file_path %}
                                    <a href="{% url 'report_execution_download' execution.pk %}" class="btn-download">
                                        üíæ –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏
                                    </a>
                                {% endif %}
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <div class="empty-state">
                        <div class="empty-icon">üìä</div>
                        <p>–í–∏ —â–µ –Ω–µ —Å—Ç–≤–æ—Ä—é–≤–∞–ª–∏ –∑–≤—ñ—Ç–∏</p>
                    </div>
                {% endif %}
            </div>
        </div>

        <!-- –®–∞–±–ª–æ–Ω–∏ -->
        <div class="col-md-6">
            <div class="section">
                <h2 class="section-title">
                    <span>üìã –ú–æ—ó —à–∞–±–ª–æ–Ω–∏</span>
                    <a href="{% url 'report_template_list' %}" class="section-link">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤—Å—ñ ‚Üí</a>
                </h2>

                {% if templates %}
                    <ul class="recent-list">
                        {% for template in templates %}
                        <li class="recent-item">
                            <div>
                                <div class="recent-item-title">{{ template.name }}</div>
                                <div class="recent-item-meta">
                                    {{ template.get_report_type_display|default:template.report_type }} ‚Ä¢ 
                                    {{ template.created_at|date:"d.m.Y" }}
                                </div>
                            </div>
                            <div class="recent-item-actions">
                                <a href="{% url 'report_template_update' template.pk %}" class="btn-download" style="background-color: #3b82f6;">
                                    ‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏
                                </a>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <div class="empty-state">
                        <div class="empty-icon">üìã</div>
                        <p>–ù–µ–º–∞—î –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö —à–∞–±–ª–æ–Ω—ñ–≤</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% if not templates and not recent_executions %}
<!-- –î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –¥–ª—è –Ω–æ–≤–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ -->
<div class="pdf-reports-container">
    <div class="section">
        <h2 class="section-title">üéØ –Ø–∫ –ø–æ—á–∞—Ç–∏ —Ä–æ–±–æ—Ç—É –∑ PDF –∑–≤—ñ—Ç–∞–º–∏</h2>
        
        <div class="row">
            <div class="col-md-4 mb-3">
                <div class="card border-0 bg-light h-100">
                    <div class="card-body">
                        <h5 class="card-title">üìù –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–≤—ñ—Ç—É</h5>
                        <p class="card-text">
                            1. –í–∏–±–µ—Ä—ñ—Ç—å —Ç–∏–ø –∑–≤—ñ—Ç—É<br>
                            2. –ó–∞–ø–æ–≤–Ω—ñ—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏<br>
                            3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏"<br>
                            4. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ PDF
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-3">
                <div class="card border-0 bg-light h-100">
                    <div class="card-body">
                        <h5 class="card-title">üíæ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —à–∞–±–ª–æ–Ω—ñ–≤</h5>
                        <p class="card-text">
                            –ü—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–≤—ñ—Ç—É –∑–±–µ—Ä–µ–∂—ñ—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —è–∫ —à–∞–±–ª–æ–Ω –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-3">
                <div class="card border-0 bg-light h-100">
                    <div class="card-body">
                        <h5 class="card-title">üìä –î–æ—Å—Ç—É–ø–Ω—ñ —Ç–∏–ø–∏ –∑–≤—ñ—Ç—ñ–≤</h5>
                        <p class="card-text">
                            ‚Ä¢ –ó–∞–ª–∏—à–∫–∏ –Ω–∞ —Å–∫–ª–∞–¥–∞—Ö<br>
                            ‚Ä¢ –ù–∞–¥—Ö–æ–¥–∂–µ–Ω–Ω—è –∑ –ø–æ–ª—ñ–≤<br>
                            ‚Ä¢ –í–≤–µ–∑–µ–Ω–Ω—è/–≤–∏–≤–µ–∑–µ–Ω–Ω—è<br>
                            ‚Ä¢ –î–∏–Ω–∞–º—ñ–∫–∞ –∑–º—ñ–Ω
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/live_clock.js' %}"></script>
<script>
    // –î–æ–¥–∞—Ç–∫–æ–≤–∏–π JavaScript –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è UX
    document.addEventListener('DOMContentLoaded', function() {
        // –ê–Ω—ñ–º–∞—Ü—ñ—è –∫–∞—Ä—Ç–æ–∫ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ
        const cards = document.querySelectorAll('.report-type-card');
        cards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-5px)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });
        
        // –ü—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ –≤ —Å–ø–∏—Å–∫—É
        const listItems = document.querySelectorAll('.recent-item');
        listItems.forEach(item => {
            item.addEventListener('mouseenter', function() {
                this.style.backgroundColor = '#f8f9fa';
            });
            
            item.addEventListener('mouseleave', function() {
                this.style.backgroundColor = '';
            });
        });
    });
</script>
{% endblock %}